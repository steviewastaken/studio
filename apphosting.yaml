
# Specifies the version of the App Hosting schema.
specVersion: v1alpha1

# Defines the build configuration.
build:
  builder: docker
  dockerfile: Dockerfile
  # This makes secrets available as environment variables during the build process.
  # This is the correct, secure way to handle build-time secrets.
  env:
    - variable: NEXT_PUBLIC_SUPABASE_URL
      secret: NEXT_PUBLIC_SUPABASE_URL
    - variable: NEXT_PUBLIC_SUPABASE_ANON_KEY
      secret: NEXT_PUBLIC_SUPABASE_ANON_KEY
    - variable: NEXT_PUBLIC_GOOGLE_CLIENT_API_KEY
      secret: NEXT_PUBLIC_GOOGLE_CLIENT_API_KEY
    - variable: GOOGLE_SERVER_API_KEY
      secret: GOOGLE_SERVER_API_KEY

# Defines the runtime configuration.
run:
  # Number of instances to run.
  instanceCount: 1
  # This makes secrets available to the running application at runtime.
  secrets:
    - secret: GOOGLE_SERVER_API_KEY
    - secret: NEXT_PUBLIC_SUPABASE_URL
    - secret: NEXT_PUBLIC_SUPABASE_ANON_KEY
    - secret: NEXT_PUBLIC_GOOGLE_CLIENT_API_KEY
